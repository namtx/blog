<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> SSL | namtx.dev </title> <meta name="description" content=" Ruby on Rails, Devops and more "> <meta name="keywords" content="blog, web, devops, ruby on rails"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Tran Xuan Nam"> <meta property="article:section" content=""> <meta property="article:tag" content=""> <meta property="article:published_time" content="2021-03-18 00:00:00 +0000"> <meta property="og:url" content="https://namtx.github.io/2021/ssl/"> <meta property="og:title" content=" SSL | namtx.dev "> <meta property="og:image" content="https://namtx.github.io"> <meta property="og:description" content=" Ruby on Rails, Devops and more "> <meta property="og:site_name" content="Tran Xuan Nam"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" SSL | namtx.dev "> <meta name="twitter:description" content=" Ruby on Rails, Devops and more "> <meta name="twitter:image:src" content="https://namtx.github.io"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" SSL | namtx.dev "> <meta itemprop="description" content=" Ruby on Rails, Devops and more "> <meta itemprop="image" content="https://namtx.github.io"> <!-- Canonical link tag --> <link rel="canonical" href="https://namtx.github.io/2021/ssl/"> <link rel="alternate" type="application/rss+xml" title="namtx.dev" href="https://namtx.github.io/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="https://namtx.github.io/assets/css/main.css"> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="icon" href="/favicon.ico" type="image/x-icon"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="https://namtx.github.io/">namtx<span>.dev</span></a></h1> <ul class="navbar"> <li><a href="https://namtx.github.io/about">About me</a></li> <li><a href="https://bookmarks.namtx.now.sh/" target="_blank">Bookmarks</a></li> <li><a href="https://namtx.github.io/til">TIL</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2021-03-18T00:00:00+00:00" itemprop="datePublished">Mar 18, 2021</time></p> <h1 class="post-title" itemprop="name headline">SSL</h1> </header> <div class="post-content" itemprop="articleBody"> <p> </p> <p>Hỏi SSL: Moi người cho mình hỏi, hiện tại mình thấy có 2 dạng handle SSL cho server:</p> <p>Một là ở app level, ví dụ khi init một cái HTTP server thì chỉ định luôn SSL cert, ví dụ:</p> <p>err := http.ListenAndServeTLS(“:443”, “server.crt”, “server.key”, nil)</p> <p>Một cách khác là handle ở Nginx (về lý thuyết chắc nó cũng là app level nhỉ):</p> <p>server { listen 443 ssl; server_name www.example.com; ssl_certificate www.example.com.crt; ssl_certificate_key www.example.com.key;</p> <p>Còn dạng thứ hai là dùng SSL thông qua gateway provider như Cloudflare, hay Heroku.</p> <p>Không biết ưu nhược điểm của từng cách trên là như thế nào nhỉ?</p> <p>3 kiểu trên thật ra cũng là dạng 1 cái app nào đó load cert lên rồi handleshake client request thôi. Khác nhau chính là setup ở layer nào thôi</p> <p>Khác nhau cách 1 và 2/3 là:</p> <ul> <li>1 là App level hoặc có thể hiểu là Business level</li> <li>2/3 là dạng proxy level. Lúc này proxy service (nginx/cloudflare,aws certificates + gateway) sẽ keep connection tới server bằng bất cứ kiểu gì, ko nhất thiết phải là https</li> </ul> <p>Khác nhau cách 1/2 và 3 là:</p> <ul> <li>Tự mình handle/configure</li> <li>External provider service</li> </ul> <p>Ưu nhược</p> <ul> <li>Cách 1:</li> <li>Ưu điểm: <ul> <li>Gọn, nhẹ, 1 binary/docker có thể có tất cả.</li> <li>Không cần setup thêm service ngoài để làm ssl</li> <li>Có thể custom code để làm nhiều trò theo ý thích</li> </ul> </li> <li>Nhược: <ul> <li>Mix giữa business level và connection level</li> <li>Về căn bản thì nhiều business app không care tới ssl gì, allowanced domains support là gì, vì nó ko phải trách nhiệm của app</li> <li>Renew invalid các kiểu manually. Hoặc nếu tự động thì phải có cơ chế expitre + re-load</li> <li>Hạn chế khi share certificate, hoặc proxy 1 request vào nhiều app</li> </ul> </li> <li>Cách 2:</li> <li>Ưu điểm: * Tách business level ra khỏi infra level * Dễ dàng setup 1 proxy nhiều ssl để routing nhiều app khác nhau * Dễ dàng setup 1 proxy 1 ssl để routing routing khác nhau * Khi cần thay thế/renew thì chỉ thay đổi/configure proxy level thôi, ko cần stop business level * Đa phần support hết case rồi, chỉ học cách configure thôi</li> <li> <p>Nhược điểm: * Phải setup service riêng để handle request trước khi nó vào app * Nếu làm mấy thứ phức tạp quá (VD build 1 cái proxy service đem bán) thì nhiều khi ko support hết, phải tự viết thêm * Phải học cách config nhiều để turning performance</p> </li> <li>Cách 3:</li> <li>Ưu điểm: <ul> <li>Infra nhà người ta, mình ko cần mantain</li> <li>Configure đễ hơn cách 2</li> <li>Có nhiều món ăn kèm như chống ddos, cache bla bla mà ko cần setup/plugin thêm</li> <li>External provider sẽ face ra internet chứ ko phải cụm server của mình. Nên nếu có gì sảy ra thì external provider sẽ bị tấn công chứ ko phải mình</li> </ul> </li> <li>Nhược điểm <ul> <li>Tiền khi nhu cầu vượt basic</li> <li>Mình không quản lý/control hết tất cả</li> <li>Phải setup cái flow hợp lý khi dev/test/prod</li> <li>Không phải cái gì cũng như mình muốn, mà mình phải follow cái nó cung cấp</li> </ul> </li> </ul> <p>Source: webuild</p> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2021 Tran Xuan Nam &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/heiswayi/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
